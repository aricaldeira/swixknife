{%- set DAYS = SezimalList([
    SezimalList([ 0,  1,  2,  3,  4,  5]),
    SezimalList([10, 11, 12, 13, 14, 15]),
    SezimalList([20, 21, 22, 23, 24, 25]),
    SezimalList([30, 31, 32, 33, 34, 35]),
    SezimalList([40, 41, 42, 43, 44, 45]),
    SezimalList([50, 51, 52, 53, 54, 55]),
    ])
-%}
{%- set WEEKDAYS = SezimalList([0, 1, 2, 3, 4, 5]) -%}
{%- set WEEKDAY_BORDER_LEFT = 5 -%}
{%- set WEEKDAY_BORDER_RIGHT = 0 -%}
{%- set SHADES = SezimalList([shade_01, shade_02, shade_03, shade_04, shade_05, shade_10]) -%}
{%- set BACK_SHADES = SezimalList([back_shade_01, back_shade_02, back_shade_03, back_shade_04, back_shade_05, back_shade_10]) -%}
{%- set TEXT_SHADES = SezimalList([text_shade_01, text_shade_02, text_shade_03, text_shade_04, text_shade_05, text_shade_10]) -%}

{%- set dcc_month_number = SezimalInteger(dcc_month_number) -%}
{%- set dcc_year_number = SezimalInteger(dcc_year_number) -%}

{%- if dcc_month_number == 14 -%}
    {%- set weeks = SezimalList([140]) -%}
{%- else -%}
    {%- set weeks = SezimalList([
        (SezimalInteger(dcc_month_number) * 10) + 0,
        (SezimalInteger(dcc_month_number) * 10) + 1,
        (SezimalInteger(dcc_month_number) * 10) + 2,
        (SezimalInteger(dcc_month_number) * 10) + 3,
        (SezimalInteger(dcc_month_number) * 10) + 4,
        (SezimalInteger(dcc_month_number) * 10) + 5,
    ]) -%}
{%- endif -%}

{%- set NUMBERS_DAYS = SezimalDictionary({
     0: '0‐0',  1: '0‐1',  2: '0‐2',  3: '0‐3',  4: '0‐4',  5: '0‐5',
    10: '1‐0', 11: '1‐1', 12: '1‐2', 13: '1‐3', 14: '1‐4', 15: '1‐5',
    20: '2‐0', 21: '2‐1', 22: '2‐2', 23: '2‐3', 24: '2‐4', 25: '2‐5',
    30: '3‐0', 31: '3‐1', 32: '3‐2', 33: '3‐3', 34: '3‐4', 35: '3‐5',
    40: '4‐0', 41: '4‐1', 42: '4‐2', 43: '4‐3', 44: '4‐4', 45: '4‐5',
    50: '5‐0', 51: '5‐1', 52: '5‐2', 53: '5‐3', 54: '5‐4', 55: '5‐5',
}) -%}

{%- if base == 14 -%}
    {%- set NUMBERS = SezimalDictionary({0: '0', 1: '1', 2: '2', 3: '3', 4: '4', 5: '5', 10: '6', 11: '7', 12: '8', 13: '9', 14: '10', 15: '11', 20: '12', 21: '13', 22: '14', 23: '15', 24: '16', 25: '17', 30: '18', 31: '19', 32: '20', 33: '21', 34: '22', 35: '23', 40: '24', 41: '25', 42: '26', 43: '27', 44: '28', 45: '29', 50: '30', 51: '31', 52: '32', 53: '33', 54: '34', 55: '35', 100: '36', 101: '37', 102: '38', 103: '39', 104: '40', 105: '41', 110: '42', 111: '43', 112: '44', 113: '45', 114: '46', 115: '47', 120: '48', 121: '49', 122: '50', 123: '51', 124: '52', 125: '53', 130: '54', 131: '55', 132: '56', 133: '57', 134: '58', 135: '59', 140: '60', 141: '61', 1400: '360', 1410: '366'}) -%}
{%- elif base == 20 -%}
    {%- set NUMBERS = SezimalDictionary({0: '0', 1: '1', 2: '2', 3: '3', 4: '4', 5: '5', 10: '6', 11: '7', 12: '8', 13: '9', 14: '↊', 15: '↋', 20: '10', 21: '11', 22: '12', 23: '13', 24: '14', 25: '15', 30: '16', 31: '17', 32: '18', 33: '19', 34: '1↊', 35: '1↋', 40: '20', 41: '21', 42: '22', 43: '23', 44: '24', 45: '25', 50: '26', 51: '27', 52: '28', 53: '29', 54: '2↊', 55: '2↋', 100: '30', 101: '31', 102: '32', 103: '33', 104: '34', 105: '35', 110: '36', 111: '37', 112: '38', 113: '39', 114: '3↊', 115: '3↋', 120: '40', 121: '41', 122: '42', 123: '43', 124: '44', 125: '45', 130: '46', 131: '47', 132: '48', 133: '49', 134: '4↊', 135: '4↋', 140: '50', 141: '51', 1404: '260', 1410: '266'}) -%}
{%- elif base == 100 -%}
    {%- set NUMBERS = SezimalDictionary({0: '0', 1: '1', 2: '2', 3: '3', 4: '4', 5: '5', 10: '0̇', 11: '1̇', 12: '2̇', 13: '3̇', 14: '4̇', 15: '5̇', 20: '0̈', 21: '1̈', 22: '2̈', 23: '3̈', 24: '4̈', 25: '5̈', 30: '0̊', 31: '1̊', 32: '2̊', 33: '3̊', 34: '4̊', 35: '5̊', 40: '0̄', 41: '1̄', 42: '2̄', 43: '3̄', 44: '4̄', 45: '5̄', 50: '0̆', 51: '1̆', 52: '2̆', 53: '3̆', 54: '4̆', 55: '5̆', 100: '10', 101: '11', 102: '12', 103: '13', 104: '14', 105: '15', 110: '10̇', 111: '11̇', 112: '12̇', 113: '13̇', 114: '14̇', 115: '15̇', 120: '10̈', 121: '11̈', 122: '12̈', 123: '13̈', 124: '14̈', 125: '15̈', 130: '10̊', 131: '11̊', 132: '12̊', 133: '13̊', 134: '14̊', 135: '15̊', 140: '10̄', 141: '11̄', 1400: '4̇0', 1415: '4̇0̇'}) -%}
    {%- if sezimal_digits or format_token == '@!' -%}
        {%- set NUMBERS = SezimalDictionary({0: '󱸀', 1: '󱸁', 2: '󱸂', 3: '󱸃', 4: '󱸄', 5: '󱸅', 10: '󱸆', 11: '󱸇', 12: '󱸈', 13: '󱸉', 14: '󱸊', 15: '󱸋', 20: '󱸌', 21: '󱸍', 22: '󱸎', 23: '󱸏', 24: '󱸐', 25: '󱸑', 30: '󱸒', 31: '󱸓', 32: '󱸔', 33: '󱸕', 34: '󱸖', 35: '󱸗', 40: '󱸘', 41: '󱸙', 42: '󱸚', 43: '󱸛', 44: '󱸜', 45: '󱸝', 50: '󱸞', 51: '󱸟', 52: '󱸠', 53: '󱸡', 54: '󱸢', 55: '󱸣', 100: '󱸁󱸀', 101: '󱸁󱸁', 102: '󱸁󱸂', 103: '󱸁󱸃', 104: '󱸁󱸄', 105: '󱸁󱸅', 110: '󱸁󱸆', 111: '󱸁󱸇', 112: '󱸁󱸈', 113: '󱸁󱸉', 114: '󱸁󱸊', 115: '󱸁󱸋', 120: '󱸁󱸌', 121: '󱸁󱸍', 122: '󱸁󱸎', 123: '󱸁󱸏', 124: '󱸁󱸐', 125: '󱸁󱸑', 130: '󱸁󱸒', 131: '󱸁󱸓', 132: '󱸁󱸔', 133: '󱸁󱸕', 134: '󱸁󱸖', 135: '󱸁󱸗', 140: '󱸁󱸘', 141: '󱸁󱸙', 1400: '󱸊󱸀', 1415: '󱸊󱸆'}) -%}
    {%- elif format_token == 'Z' -%}
        {%- set NUMBERS = SezimalDictionary({0: '0', 1: '1', 2: '2', 3: '3', 4: '4', 5: '5', 10: '6', 11: '7', 12: '8', 13: '9', 14: 'A', 15: 'B', 20: 'C', 21: 'D', 22: 'E', 23: 'F', 24: 'G', 25: 'H', 30: 'I', 31: 'J', 32: 'K', 33: 'L', 34: 'M', 35: 'N', 40: 'O', 41: 'P', 42: 'Q', 43: 'R', 44: 'S', 45: 'T', 50: 'U', 51: 'V', 52: 'W', 53: 'X', 54: 'Y', 55: 'Z', 100: '10', 101: '11', 102: '12', 103: '13', 104: '14', 105: '15', 110: '16', 111: '17', 112: '18', 113: '19', 114: '1A', 115: '1B', 120: '1C', 121: '1D', 122: '1E', 123: '1F', 124: '1G', 125: '1H', 130: '1I', 131: '1J', 132: '1K', 133: '1L', 134: '1M', 135: '1N', 140: '1O', 141: '1P', 1400: 'A0', 1410: 'A6'}) -%}
    {%- endif -%}
{%- else -%}
    {%- set NUMBERS = SezimalDictionary({0: '0', 1: '1', 2: '2', 3: '3', 4: '4', 5: '5', 10: '10', 11: '11', 12: '12', 13: '13', 14: '14', 15: '15', 20: '20', 21: '21', 22: '22', 23: '23', 24: '24', 25: '25', 30: '30', 31: '31', 32: '32', 33: '33', 34: '34', 35: '35', 40: '40', 41: '41', 42: '42', 43: '43', 44: '44', 45: '45', 50: '50', 51: '51', 52: '52', 53: '53', 54: '54', 55: '55', 100: '100', 101: '101', 102: '102', 103: '103', 104: '104', 105: '105', 110: '110', 111: '111', 112: '112', 113: '113', 114: '114', 115: '115', 120: '120', 121: '121', 122: '122', 123: '123', 124: '124', 125: '125', 130: '130', 131: '131', 132: '132', 133: '133', 134: '134', 135: '135', 140: '140', 141: '141', 1400: '1400', 1410: '1410'}) -%}

    {%- if sezimal_digits or '!' in format_token -%}
        {%- set NUMBERS = SezimalDictionary({0: '󱸀', 1: '󱸁', 2: '󱸂', 3: '󱸃', 4: '󱸄', 5: '󱸅', 10: '󱸁󱸀', 11: '󱸁󱸁', 12: '󱸁󱸂', 13: '󱸁󱸃', 14: '󱸁󱸄', 15: '󱸁󱸅', 20: '󱸂󱸀', 21: '󱸂󱸁', 22: '󱸂󱸂', 23: '󱸂󱸃', 24: '󱸂󱸄', 25: '󱸂󱸅', 30: '󱸃󱸀', 31: '󱸃󱸁', 32: '󱸃󱸂', 33: '󱸃󱸃', 34: '󱸃󱸄', 35: '󱸃󱸅', 40: '󱸄󱸀', 41: '󱸄󱸁', 42: '󱸄󱸂', 43: '󱸄󱸃', 44: '󱸄󱸄', 45: '󱸄󱸅', 50: '󱸅󱸀', 51: '󱸅󱸁', 52: '󱸅󱸂', 53: '󱸅󱸃', 54: '󱸅󱸄', 55: '󱸅󱸅', 100: '󱸁󱸀󱸀', 101: '󱸁󱸀󱸁', 102: '󱸁󱸀󱸂', 103: '󱸁󱸀󱸃', 104: '󱸁󱸀󱸄', 105: '󱸁󱸀󱸅', 110: '󱸁󱸁󱸀', 111: '󱸁󱸁󱸁', 112: '󱸁󱸁󱸂', 113: '󱸁󱸁󱸃', 114: '󱸁󱸁󱸄', 115: '󱸁󱸁󱸅', 120: '󱸁󱸂󱸀', 121: '󱸁󱸂󱸁', 122: '󱸁󱸂󱸂', 123: '󱸁󱸂󱸃', 124: '󱸁󱸂󱸄', 125: '󱸁󱸂󱸅', 130: '󱸁󱸃󱸀', 131: '󱸁󱸃󱸁', 132: '󱸁󱸃󱸂', 133: '󱸁󱸃󱸃', 134: '󱸁󱸃󱸄', 135: '󱸁󱸃󱸅', 140: '󱸁󱸄󱸀', 141: '󱸁󱸄󱸁',  1400: '󱸁󱸄󱸀󱸀', 1410: '󱸁󱸄󱸁󱸀'}) -%}
    {%- endif -%}
    {%- set NUMBERS_DAYS = NUMBERS -%}
{%- endif -%}

{%- if (not year_view) -%}
    {%- set MONTH_LINE_HEIGHT = '3rem' -%}
    {%- set WEEK_LINE_HEIGHT = '2.5rem' -%}
    {%- set MONTH_FONT_SIZE = '1.5rem' -%}
    {%- set WEEK_FONT_SIZE = '0.80rem' -%}
    {%- set DAY_IN_YEAR_FONT_SIZE = '0.50rem' -%}
    {%- set EMOJI_FONT_SIZE = '1.5rem' -%}
    {%- set DATE_FONT_SIZE = '1.30rem' -%}
    {%- set TODAY_FONT_SIZE = '1.60rem' -%}
    {%- set EVENTS_FONT_SIZE = '1rem' -%}
{%- else -%}
    {%- set MONTH_LINE_HEIGHT = '2rem' -%}
    {%- set WEEK_LINE_HEIGHT = '1.5rem' -%}
    {%- set MONTH_FONT_SIZE = '1rem' -%}
    {%- set WEEK_FONT_SIZE = '0.50rem' -%}
    {%- set DAY_IN_YEAR_FONT_SIZE = '0.30rem' -%}
    {%- set EMOJI_FONT_SIZE = '1.2rem' -%}
    {%- set DATE_FONT_SIZE = '1rem' -%}
    {%- set TODAY_FONT_SIZE = '1.10rem' -%}
    {%- set EVENTS_FONT_SIZE = '0.75rem' -%}
{%- endif -%}

{%- if locale.DIGITS and (base in (10, 14)) and (format_token != '!') -%}
    {%- for i in NUMBERS -%}
        {%- set NUMBERS = NUMBERS.update({i: locale.digit_replace(NUMBERS[i])}) -%}
    {%- endfor -%}
{%- endif -%}

{%- if week_view and date.dcc_month == dcc_month_number -%}
    {%- set week_color = date.dcc_week_in_year -%}
{%- else -%}
    {%- set week_color = weeks[0] -%}
{%- endif -%}

{% set ns = namespace() %}
{% set ns.date_has_event = False %}

{%- if month_view or week_view -%}
{%- else -%}
<table class="center" style="border-spacing: 0px;">
    <colgroup>
        <col span="1">
        <col span="1">
        <col span="1">
        <col span="1">
    </colgroup>
    <tr style="vertical-align: middle;">
        {%- if locale.RTL -%}
            <td style="line-height: {{MONTH_LINE_HEIGHT}}; background-color: {{colors[weeks[0]][shade_month]}}; color: {{'black' if gray_scale else 'white'}}; font-weight: bold;">
                {%- if base != 10 -%}
                    {{ NUMBERS[dcc_month_number] }}
                {%- else -%}
                    {{ locale.dcc_month_abbreviated_name(dcc_month_number) }}
                {%- endif -%}
            </td>
        {%- else -%}
            {%- if dcc_month_number in (0, 1) -%}
                <td style="line-height: {{MONTH_LINE_HEIGHT}}; background-color: {{colors[weeks[0]][shade_month]}}; color: {{'black' if gray_scale else 'white'}}; font-weight: bold;">{{ locale.dcc_term_abbreviated_name(0) }}</td>
            {%- elif dcc_month_number in (2, 3) -%}
                <td style="line-height: {{MONTH_LINE_HEIGHT}}; background-color: {{colors[weeks[0]][shade_month]}}; color: {{'black' if gray_scale else 'white'}}; font-weight: bold;">{{ locale.dcc_term_abbreviated_name(1) }}</td>
            {%- elif dcc_month_number in (4, 5) -%}
                <td style="line-height: {{MONTH_LINE_HEIGHT}}; background-color: {{colors[weeks[0]][shade_month]}}; color: {{'black' if gray_scale else 'white'}}; font-weight: bold;">{{ locale.dcc_term_abbreviated_name(2) }}</td>
            {%- elif dcc_month_number in (10, 11) -%}
                <td style="line-height: {{MONTH_LINE_HEIGHT}}; background-color: {{colors[weeks[0]][shade_month]}}; color: {{'black' if gray_scale else 'white'}}; font-weight: bold;">{{ locale.dcc_term_abbreviated_name(3) }}</td>
            {%- else -%}
                <td style="line-height: {{MONTH_LINE_HEIGHT}}; background-color: {{colors[weeks[0]][shade_month]}}; color: {{'black' if gray_scale else 'white'}}; font-weight: bold;">{{ locale.dcc_term_abbreviated_name(4) }}</td>
            {%- endif -%}
        {%- endif -%}
        <td colspan="2" style="line-height: {{MONTH_LINE_HEIGHT}}; background-color: {{colors[weeks[0]][shade_month]}}; color: {{'black' if gray_scale else 'white'}}; font-weight: bold; font-size: {{MONTH_FONT_SIZE}};">
            {%- if 'c' in format_token -%}
                {%- if now_view -%}
                    {{ now.format(locale.ADC_YEAR_TEXT_MONTH_FORMAT, locale) }}
                {%- else -%}
                    {{ locale.upper(locale.ADC_MONTH_NAME[int(dcc_month_number)]) }}
                {%- endif -%}
                &nbsp;{{ locale.ADC_MONTH_ICON[int(dcc_month_number)] }}
            {%- else -%}
                {%- if now_view -%}
                    {{ now.format(locale.DCC_YEAR_TEXT_MONTH_FORMAT, locale) }}
                {%- else -%}
                    {{ locale.upper(locale.DCC_MONTH_NAME[int(dcc_month_number)]) }}
                {%- endif -%}
            {%- endif -%}
        </td>
        {%- if locale.RTL -%}
            {%- if dcc_month_number in (0, 1) -%}
                <td style="line-height: {{MONTH_LINE_HEIGHT}}; background-color: {{colors[weeks[0]][shade_month]}}; color: {{'black' if gray_scale else 'white'}}; font-weight: bold;">{{ locale.dcc_term_abbreviated_name(0) }}</td>
            {%- elif dcc_month_number in (2, 3) -%}
                <td style="line-height: {{MONTH_LINE_HEIGHT}}; background-color: {{colors[weeks[0]][shade_month]}}; color: {{'black' if gray_scale else 'white'}}; font-weight: bold;">{{ locale.dcc_term_abbreviated_name(1) }}</td>
            {%- elif dcc_month_number in (4, 5) -%}
                <td style="line-height: {{MONTH_LINE_HEIGHT}}; background-color: {{colors[weeks[0]][shade_month]}}; color: {{'black' if gray_scale else 'white'}}; font-weight: bold;">{{ locale.dcc_term_abbreviated_name(2) }}</td>
            {%- elif dcc_month_number in (10, 11) -%}
                <td style="line-height: {{MONTH_LINE_HEIGHT}}; background-color: {{colors[weeks[0]][shade_month]}}; color: {{'black' if gray_scale else 'white'}}; font-weight: bold;">{{ locale.dcc_term_abbreviated_name(3) }}</td>
            {%- else -%}
                <td style="line-height: {{MONTH_LINE_HEIGHT}}; background-color: {{colors[weeks[0]][shade_month]}}; color: {{'black' if gray_scale else 'white'}}; font-weight: bold;">{{ locale.dcc_term_abbreviated_name(4) }}</td>
            {%- endif -%}
        {%- else -%}
            <td style="line-height: {{MONTH_LINE_HEIGHT}}; background-color: {{colors[weeks[0]][shade_month]}}; color: {{'black' if gray_scale else 'white'}}; font-weight: bold; vertical-align: middle;">
                {%- if base != 10 -%}
                    {{ NUMBERS[dcc_month_number] }}
                {%- else -%}
                    {{ locale.dcc_month_abbreviated_name(dcc_month_number) }}
                {%- endif -%}
            </td>
        {%- endif -%}
    </tr>
</table>
{%- endif -%}
<table class="center" style="border-spacing: 0px;">
    <colgroup>
    {%- if not year_view -%}
        <col span="1" width="10%">
        <col span="1" width="15%">
        <col span="1" width="15%">
        <col span="1" width="15%">
        <col span="1" width="15%">
        <col span="1" width="15%">
        <col span="1" width="15%">
    {%- else -%}
        <col span="1">
        <col span="1">
        <col span="1">
        <col span="1">
        <col span="1">
        <col span="1">
        <col span="1">
    {%- endif -%}
    </colgroup>
    <tr style="vertical-align: middle;">
        <td style="line-height: {{WEEK_LINE_HEIGHT}}; font-size: {{DATE_FONT_SIZE}}; color: {{colors[week_color][shade_week_number]}}; font-size: {{WEEK_FONT_SIZE}}; border-{{ 'left' if locale.RTL else 'right' }}: 1px solid {{colors[week_color][shade_week_number]}}; border-bottom: 1px solid {{colors[week_color][shade_week_number]}};">{{ locale.WEEK_NUMBER_SYMBOL }}</td>
        {%- if weekday_name_size > 1 -%}
            {%- for i in SezimalRange(10) -%}
                <td style="line-height: {{WEEK_LINE_HEIGHT}}; font-size: {{DATE_FONT_SIZE}}; color: {{colors[week_color][SHADES[i]]}}; {%- if date.dcc_month == dcc_month_number and date.dcc_weekday == WEEKDAYS[i] -%}background-color: {{ colors[week_color][BACK_SHADES[i]] }}; color: {{ colors[week_color][TEXT_SHADES[i]] }}; font-weight: bold; font-size: {{TODAY_FONT_SIZE}};{%- endif -%} border-bottom: 1px solid;{%- if WEEKDAYS[i] == WEEKDAY_BORDER_LEFT -%} border-{{ 'right' if locale.RTL else 'left' }}: 3px solid {{colors[week_color][SHADES[i]]}};{%- endif -%}{%- if WEEKDAYS[i] == WEEKDAY_BORDER_RIGHT -%} border-{{ 'left' if locale.RTL else 'right' }}: 3px solid {{colors[week_color][SHADES[i]]}};{%- endif -%}">
                {%- if 'c' in format_token -%}
                    <span class="hide-in-mobile">{{ locale.upper(locale.adc_weekday_abbreviated_name(i)) }}</span>
                    <span class="show-in-mobile">{{ locale.upper(locale.adc_weekday_symbol(i)) }}</span>
                    {{ locale.ADC_WEEKDAY_ICON[i] }}
                {%- else -%}
                    {{ locale.upper(locale.dcc_weekday_abbreviated_name(i)) }}
                {%- endif -%}
                </td>
            {%- endfor -%}
        {%- else -%}
            {%- for i in SezimalRange(10) -%}
                <td style="line-height: {{WEEK_LINE_HEIGHT}}; font-size: {{DATE_FONT_SIZE}}; color: {{colors[week_color][SHADES[i]]}}; {%- if date.dcc_month == dcc_month_number and date.dcc_weekday == WEEKDAYS[i] -%}background-color: {{ colors[week_color][BACK_SHADES[i]] }}; color: {{ colors[week_color][TEXT_SHADES[i]] }}; font-weight: bold; font-size: {{TODAY_FONT_SIZE}};{%- endif -%} border-bottom: 1px solid;{%- if WEEKDAYS[i] == WEEKDAY_BORDER_LEFT -%} border-{{ 'right' if locale.RTL else 'left' }}: 3px solid {{colors[week_color][SHADES[i]]}};{%- endif -%}{%- if WEEKDAYS[i] == WEEKDAY_BORDER_RIGHT -%} border-{{ 'left' if locale.RTL else 'right' }}: 3px solid {{colors[week_color][SHADES[i]]}};{%- endif -%}">
                {%- if 'c' in format_token -%}
                    {{ locale.upper(locale.adc_weekday_symbol(i)) + locale.ADC_WEEKDAY_ICON[i] }}
                {%- else -%}
                    {{ locale.upper(locale.dcc_weekday_symbol(i)) }}
                {%- endif -%}
                </td>
            {%- endfor -%}
        {%- endif -%}
    </tr>
</table>
{%- if month_view -%}
</div>
{%- endif -%}
<table class="center" style="border-spacing: 0px;" id="month_table_{{dcc_month_number}}">
    <colgroup>
    {%- if not year_view -%}
        <col span="1" width="10%">
        <col span="1" width="15%">
        <col span="1" width="15%">
        <col span="1" width="15%">
        <col span="1" width="15%">
        <col span="1" width="15%">
        <col span="1" width="15%">
    {%- else -%}
        <col span="1">
        <col span="1">
        <col span="1">
        <col span="1">
        <col span="1">
        <col span="1">
        <col span="1">
    {%- endif -%}
    </colgroup>
    {%- for week_in_year in weeks -%}
        {%- set week_in_month = weeks.index(week_in_year) -%}

        {%- if (not week_view) or (date.dcc_week_in_year == week_in_year) -%}
            <tr style="vertical-align: middle;">
                {%- if (not year_view) -%}
                    <td rowspan="3" style="color: {{colors[week_in_year][shade_week_number]}}; line-height: {{WEEK_FONT_SIZE}}; font-size: {{WEEK_FONT_SIZE}}; {%- if date.dcc_week_in_year == week_in_year -%}background-color: {{ colors[weeks[week_in_month]][back_shade_week_number] }}; color: {{ colors[weeks[week_in_month]][text_shade_week_number] }}; font-weight: bold;{%- endif -%} border-{{ 'left' if locale.RTL else 'right' }}: 1px solid {{colors[weeks[0]][shade_week_number]}};">
                        <span style="display: block; margin-bottom: 0.3rem;">
                            {{ '·\u2009' if week_in_year in (11, 34, 101, 124) else '.\u2009' if week_in_year in (23, 50, 113) else '\u2008\u2009' }}{{ NUMBERS[week_in_year] }}{{ '\u2009·' if week_in_year in (11, 34, 101, 124) else '\u2009.' if week_in_year in (22, 45, 112) else '\u2009\u2008' }}
                            <br/>
                        </span>
                        <span style="border-top: 2px solid {{ colors[weeks[0]][text_shade_week_number] }};">
                            <span class="hide-in-mobile">  </span>
                            {{ NUMBERS[135 if month_dates[week_in_month][-1].dcc_is_short_year else 140] }}
                            <span class="hide-in-mobile">  </span>
                        </span>
                    </td>
                {%- else -%}
                    <td style="line-height: {{WEEK_LINE_HEIGHT}}; color: {{colors[week_in_year][shade_week_number]}}; font-size: {{WEEK_FONT_SIZE}}; {%- if date.dcc_week_in_year == week_in_year -%}background-color: {{ colors[weeks[week_in_month]][back_shade_week_number] }}; color: {{ colors[weeks[week_in_month]][text_shade_week_number] }}; font-weight: bold;{%- endif -%} border-{{ 'left' if locale.RTL else 'right' }}: 1px solid {{colors[weeks[0]][shade_week_number]}};">
                        {{ '·\u2009' if week_in_year in (11, 34, 101, 124) else '.\u2009' if week_in_year in (23, 50, 113) else '\u2008\u2009' }}{{ NUMBERS[week_in_year] }}{{ '\u2009·' if week_in_year in (11, 34, 101, 124) else '\u2009.' if week_in_year in (22, 45, 112) else '\u2009\u2008' }}
                        {{ locale.ADC_WEEK_ICON[week_in_month] }}
                    </td>
                {%- endif -%}
                {%- for i in SezimalRange(10) -%}
                    {% set ns.date_has_event = False %}
                    {# Let’s see if there’s an event for the date #}
                    {%- if (not week_view) and (not month_view)
                        and SezimalInteger(dcc_month_number) in events
                        and SezimalInteger(DAYS[week_in_month][i]) in events[dcc_month_number]
                    -%}
                        {% set ns.date_has_event = True %}
                    {% endif %}
                    <td style="line-height: {{WEEK_LINE_HEIGHT}}; font-size: {{DATE_FONT_SIZE}}; color: {{colors[week_in_year][SHADES[i]]}}; {%- if month_view or week_view -%}font-weight: bold;{%- endif -%} {%- if date.dcc_month == dcc_month_number and date.dcc_day == DAYS[week_in_month][i] -%}background-color: {{ colors[weeks[week_in_month]][BACK_SHADES[i]] }}; color: {{ colors[weeks[week_in_month]][TEXT_SHADES[i]] }}; font-weight: bold; font-size: {{TODAY_FONT_SIZE}};{%- elif ns.date_has_event -%}font-style: italic; border: 2px dotted {{ colors[weeks[week_in_month]][BACK_SHADES[i]] }};{%- endif -%} {%- if WEEKDAYS[i] == WEEKDAY_BORDER_LEFT -%} border-{{ 'right' if locale.RTL else 'left' }}: 3px solid {{colors[week_in_year][SHADES[i]]}};{%- endif -%}{%- if WEEKDAYS[i] == WEEKDAY_BORDER_RIGHT -%} border-{{ 'left' if locale.RTL else 'right' }}: 3px solid {{colors[week_in_year][SHADES[i]]}};{%- endif -%}" onclick="change_date('{{ SezimalDate.from_dcc(dcc_year_number, dcc_month_number, SezimalInteger(DAYS[week_in_month][i])) }}')" {%- if date.dcc_month == dcc_month_number and date.dcc_week_in_year == week_in_year and date.dcc_weekday == WEEKDAYS[i] -%}id="today"{%- endif -%}>{{ NUMBERS_DAYS[ DAYS[week_in_month][i] ] }}</td>
                {%- endfor -%}
            </tr>
            {%- if (not year_view) -%}
                <tr style="vertical-align: middle;">
                    {%- for i in SezimalRange(10) -%}
                        <td style="font-size: {{WEEK_FONT_SIZE}}; line-height: {{WEEK_FONT_SIZE}}; color: {{colors[week_in_year][SHADES[i]]}}; {%- if date.dcc_month == dcc_month_number and date.dcc_day == DAYS[week_in_month][i] -%}background-color: {{ colors[weeks[week_in_month]][BACK_SHADES[i]] }}; color: {{ colors[weeks[week_in_month]][TEXT_SHADES[i]] }}; font-weight: bold; font-size: {{TODAY_FONT_SIZE}};{%- endif -%} {%- if SHOW_MIDQUARTER_DAY and (dcc_month_number in (2, 5, 12, 15)) and (week_in_month == 2) and (WEEKDAYS[i] == 3) -%}border-left: 2px dotted {{colors[week_in_year][SHADES[i]]}}; border-right: 2px dotted {{colors[week_in_year][SHADES[i]]}};{%- endif -%} {%- if WEEKDAYS[i] == WEEKDAY_BORDER_LEFT -%} border-{{ 'right' if locale.RTL else 'left' }}: 3px solid {{colors[week_in_year][SHADES[i]]}};{%- endif -%}{%- if WEEKDAYS[i] == WEEKDAY_BORDER_RIGHT -%} border-{{ 'left' if locale.RTL else 'right' }}: 3px solid {{colors[week_in_year][SHADES[i]]}};{%- endif -%}">
                            <span style="font-size: {{WEEK_FONT_SIZE}};">
                                {%- if (not week_view) and NUMBERS[ DAYS[week_in_month][i] ] == '' -%}
                                    &nbsp;
                                {%- else -%}
                                    {{ month_dates[week_in_month][i].format('#@W ' + locale.ISO_MONTH_DAY_FORMAT, locale) }}
                                    {%- if 'CHR' in locale.SHOW_HOLIDAYS -%}
                                        <span class="hide-in-mobile">
                                            <br/>
                                            {{month_dates[week_in_month][i].julian_date(locale)}}
                                        </span>
                                    {%- endif -%}
                                    {%- if 'JEW' in locale.SHOW_HOLIDAYS -%}
                                        <span class="hide-in-mobile">
                                            <br/>
                                            {{month_dates[week_in_month][i].hebrew_date(locale)}}
                                        </span>
                                    {%- endif -%}
                                    {%- if 'HIJ' in locale.SHOW_HOLIDAYS -%}
                                        <span class="hide-in-mobile">
                                            <br/>
                                            {{month_dates[week_in_month][i].hijri_date(locale)}}
                                        </span>
                                    {%- endif -%}
                                {%- endif -%}
                            </span>
                        </td>
                    {%- endfor -%}
                </tr>
                <tr style="vertical-align: middle;">
                    {%- for i in SezimalRange(10) -%}
                        <td class="emoji" style="font-size: {{WEEK_FONT_SIZE}}; color: {{colors[week_in_year][SHADES[i]]}}; {%- if date.dcc_month == dcc_month_number and date.dcc_day == DAYS[week_in_month][i] -%}background-color: {{ colors[weeks[week_in_month]][BACK_SHADES[i]] }}; color: {{ colors[weeks[week_in_month]][TEXT_SHADES[i]] }}; font-weight: bold; font-size: {{TODAY_FONT_SIZE}};{%- endif -%} {%- if SHOW_MIDQUARTER_DAY and (dcc_month_number in (2, 5, 12, 15)) and (week_in_month == 2) and (WEEKDAYS[i] == 3) -%}border-left: 2px dotted {{colors[week_in_year][SHADES[i]]}}; border-right: 2px dotted {{colors[week_in_year][SHADES[i]]}};{%- endif -%} {%- if WEEKDAYS[i] == WEEKDAY_BORDER_LEFT -%} border-{{ 'right' if locale.RTL else 'left' }}: 3px solid {{colors[week_in_year][SHADES[i]]}};{%- endif -%}{%- if WEEKDAYS[i] == WEEKDAY_BORDER_RIGHT -%} border-{{ 'left' if locale.RTL else 'right' }}: 3px solid {{colors[week_in_year][SHADES[i]]}};{%- endif -%}">
                            <span style="font-size: {{WEEK_FONT_SIZE}};">
                                {% set event_month = SezimalInteger(dcc_month_number) %}
                                {% set event_day = SezimalInteger(DAYS[week_in_month][i]) %}
                                {%- if event_month in events -%}
                                    {%- if event_day in events[event_month] -%}
                                        {%- for event in events[event_month][event_day] -%}
                                            {{ event.emoji }}
                                        {%- endfor -%}
                                    {%- endif -%}
                                {%- endif -%}
                                {%- if event_month in events['moon'] -%}
                                    {%- if event_day in events['moon'][event_month] -%}
                                        {%- for event in events['moon'][event_month][event_day] -%}
                                            <span class="emoji moon-emoji">{{ event.emoji }}</span>
                                        {%- endfor -%}
                                    {%- endif -%}
                                {%- endif -%}
                            </span>
                        </td>
                    {%- endfor -%}
                </tr>
            {%- endif -%}
        {%- endif -%}
    {%- endfor -%}
    {%- if (not month_view) and (not week_view) -%}
        <tr style="vertical-align: middle; font-size: {{EVENTS_FONT_SIZE}}; line-height: {{EMOJI_FONT_SIZE}};">
            <td colspan="7" style="color: {{colors[weeks[-1]][shade_04]}}">
            &nbsp;
            {%- if SezimalInteger(dcc_month_number) in events -%}
                {%- for event_day in sorted(events[dcc_month_number].keys()) -%}
                    {%- for event in events[SezimalInteger(dcc_month_number)][event_day] -%}
                        {%- if base in (14, 20) -%}
                            {{ event.date.format(' &-wM‐&-w - ', locale) }} <span class="emoji">{{ event.emoji }}</span>
                        {%- else -%}
                            {{ event.date.format(' &' + format_token + '-d - ', locale) }} <span class="emoji">{{ event.emoji }}</span>
                        {%- endif -%}
                    {%- endfor -%}
                {%- endfor -%}
            {%- endif -%}
            &nbsp;
            </td>
        </tr>
        <tr style="vertical-align: middle; font-size: {{EVENTS_FONT_SIZE}}; line-height: {{EMOJI_FONT_SIZE}};">
            <td colspan="7" style="font-size: {{WEEK_FONT_SIZE}}; line-height: {{EMOJI_FONT_SIZE}}; color: {{colors[weeks[-1]][shade_04]}}">
            {%- if SezimalInteger(dcc_month_number) in events['moon'] -%}
                {%- for event_day in sorted(events['moon'][dcc_month_number].keys()) -%}
                    {%- for event in events['moon'][SezimalInteger(dcc_month_number)][event_day] -%}
                        {%- if month_view or 'ing' not in event.obs -%}
                            {%- if base in (14, 20) -%}
                                {{ event.date.format(' &-wM‐&-w - ', locale) }} <span class="emoji moon-emoji">{{ event.emoji }}</span>
                            {%- else -%}
                                {{ event.date.format(' &' + format_token + '-d - ', locale) }} <span class="emoji moon-emoji">{{ event.emoji }}</span>
                            {%- endif -%}
                        {%- endif -%}
                    {%- endfor -%}
                {%- endfor -%}
            {%- endif -%}
            </td>
        </tr>
        <tr style="vertical-align: middle;">
            <td colspan="7" style="font-size: {{WEEK_FONT_SIZE}}; line-height: {{WEEK_FONT_SIZE}};"> </td>
        </tr>
    {%- endif -%}
</table>
