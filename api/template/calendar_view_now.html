{% if not dark_mode %}
    {% include 'calendar_light_mode.html' %}
{% endif %}

{% if base == 14 %}
    {% set NUMBERS = SezimalDictionary({0: '0', 1: '1', 2: '2', 3: '3', 4: '4', 5: '5', 10: '6', 11: '7', 12: '8', 13: '9', 14: '10', 15: '11', 20: '12', 21: '13', 22: '14', 23: '15', 24: '16', 25: '17', 30: '18', 31: '19', 32: '20', 33: '21', 34: '22', 35: '23', 40: '24', 41: '25', 42: '26', 43: '27', 44: '28', 45: '29', 50: '30', 51: '31', 52: '32', 53: '33', 54: '34', 55: '35', 100: '36', 101: '37', 102: '38', 103: '39', 104: '40', 105: '41', 110: '42', 111: '43', 112: '44', 113: '45', 114: '46', 115: '47', 120: '48', 121: '49', 122: '50', 123: '51', 124: '52', 125: '53', 1404: '364', 1415: '371'}) %}

    {% set UTAS = SezimalDictionary({0: '00', 1: '01', 2: '02', 3: '03', 4: '04', 5: '05', 10: '06', 11: '07', 12: '08', 13: '09', 14: '10', 15: '11', 20: '12', 21: '13', 22: '14', 23: '15', 24: '16', 25: '17', 30: '18', 31: '19', 32: '20', 33: '21', 34: '22', 35: '23'}) %}
    {% set HOURS_24 = SezimalDictionary({0: '00', 1: '01', 2: '02', 3: '03', 4: '04', 5: '05', 10: '06', 11: '07', 12: '08', 13: '09', 14: '10', 15: '11', 20: '12', 21: '13', 22: '14', 23: '15', 24: '16', 25: '17', 30: '18', 31: '19', 32: '20', 33: '21', 34: '22', 35: '23'}) %}
    {% set HALF = '30' %}
    {% set SEPARATOR = locale.TIME_SEPARATOR %}
    {% set MIDDAY = 20 %}
    {% set SEASON_MOON_TIME_FORMAT = locale.ISO_SHORT_TIME_FORMAT %}

    {% if hour_format == '12h' %}
        {% set UTAS = SezimalDictionary({0: '0', 1: '1', 2: '2', 3: '3', 4: '4', 5: '5', 10: '6', 11: '7', 12: '8', 13: '9', 14: '10', 15: '11', 20: '12', 21: '1', 22: '2', 23: '3', 24: '4', 25: '5', 30: '6', 31: '7', 32: '8', 33: '9', 34: '10', 35: '11'}) %}
    {% endif %}
{% elif base == 20 %}
    {% set NUMBERS = SezimalDictionary({0: '0', 1: '1', 2: '2', 3: '3', 4: '4', 5: '5', 10: '6', 11: '7', 12: '8', 13: '9', 14: '↊', 15: '↋', 20: '10', 21: '11', 22: '12', 23: '13', 24: '14', 25: '15', 30: '16', 31: '17', 32: '18', 33: '19', 34: '1↊', 35: '1↋', 40: '20', 41: '21', 42: '22', 43: '23', 44: '24', 45: '25', 50: '26', 51: '27', 52: '28', 53: '29', 54: '2↊', 55: '2↋', 100: '30', 101: '31', 102: '32', 103: '33', 104: '34', 105: '35', 110: '36', 111: '37', 112: '38', 113: '39', 114: '3↊', 115: '3↋', 120: '40', 121: '41', 122: '42', 123: '43', 124: '44', 125: '45', 1404: '264', 1415: '26↋'}) %}

    {% set UTAS = SezimalDictionary({0: '.0', 1: '.1', 2: '.2', 3: '.3', 4: '.4', 5: '.5', 10: '.6', 11: '.7', 12: '.8', 13: '.9', 14: '.↊', 15: '.↋'}) %}
    {% set HOURS_24 = SezimalDictionary({0: '.0', 1: '.1', 2: '.2', 3: '.3', 4: '.4', 5: '.5', 10: '.6', 11: '.7', 12: '.8', 13: '.9', 14: '.↊', 15: '.↋'}) %}
    {% set HALF = '6' %}
    {% set SEPARATOR = '' %}
    {% set MIDDAY = 10 %}
    {% set SEASON_MOON_TIME_FORMAT = '.#↋↋u#↋↋p' %}

{% elif base == 100 %}
    {% set NUMBERS = SezimalDictionary({0: '0', 1: '1', 2: '2', 3: '3', 4: '4', 5: '5', 10: '0̇', 11: '1̇', 12: '2̇', 13: '3̇', 14: '4̇', 15: '5̇', 20: '0̈', 21: '1̈', 22: '2̈', 23: '3̈', 24: '4̈', 25: '5̈', 30: '0̊', 31: '1̊', 32: '2̊', 33: '3̊', 34: '4̊', 35: '5̊', 40: '0̄', 41: '1̄', 42: '2̄', 43: '3̄', 44: '4̄', 45: '5̄', 50: '0̆', 51: '1̆', 52: '2̆', 53: '3̆', 54: '4̆', 55: '5̆', 100: '10', 101: '11', 102: '12', 103: '13', 104: '14', 105: '15', 110: '10̇', 111: '11̇', 112: '12̇', 113: '13̇', 114: '14̇', 115: '15̇', 120: '10̈', 121: '11̈', 122: '12̈', 123: '13̈', 124: '14̈', 125: '15̈', 1404: '4̇4', 1415: '4̇5̇'}) %}
    {% set UTAS = SezimalDictionary({0: '0', 1: '1', 2: '2', 3: '3', 4: '4', 5: '5', 10: '0̇', 11: '1̇', 12: '2̇', 13: '3̇', 14: '4̇', 15: '5̇', 20: '0̈', 21: '1̈', 22: '2̈', 23: '3̈', 24: '4̈', 25: '5̈', 30: '0̊', 31: '1̊', 32: '2̊', 33: '3̊', 34: '4̊', 35: '5̊', 40: '0̄', 41: '1̄', 42: '2̄', 43: '3̄', 44: '4̄', 45: '5̄', 50: '0̆', 51: '1̆', 52: '2̆', 53: '3̆', 54: '4̆', 55: '5̆'}) %}
    {% set HOURS_24 = SezimalDictionary({0: '00', 1: '01', 2: '02', 3: '03', 4: '04', 5: '05', 10: '10', 11: '11', 12: '12', 13: '13', 14: '14', 15: '15', 20: '20', 21: '21', 22: '22', 23: '23', 24: '24', 25: '25', 30: '30', 31: '31', 32: '32', 33: '33', 34: '34', 35: '35', 40: '40', 41: '41', 42: '42', 43: '43', 44: '44', 45: '45', 50: '50', 51: '51', 52: '52', 53: '53', 54: '54', 55: '55'}) %}
    {% set HALF = '0̊' %}
    {% set SEPARATOR = locale.TIME_SEPARATOR %}
    {% set MIDDAY = 30 %}
    {% set SEASON_MOON_TIME_FORMAT = '#@u' + locale.TIME_SEPARATOR + '#@p' %}

    {% if sezimal_digits or format_token == '@!' %}
        {% set NUMBERS = SezimalDictionary({0: '󱸀', 1: '󱸁', 2: '󱸂', 3: '󱸃', 4: '󱸄', 5: '󱸅', 10: '󱸆', 11: '󱸇', 12: '󱸈', 13: '󱸉', 14: '󱸊', 15: '󱸋', 20: '󱸌', 21: '󱸍', 22: '󱸎', 23: '󱸏', 24: '󱸐', 25: '󱸑', 30: '󱸒', 31: '󱸓', 32: '󱸔', 33: '󱸕', 34: '󱸖', 35: '󱸗', 40: '󱸘', 41: '󱸙', 42: '󱸚', 43: '󱸛', 44: '󱸜', 45: '󱸝', 50: '󱸞', 51: '󱸟', 52: '󱸠', 53: '󱸡', 54: '󱸢', 55: '󱸣', 100: '󱸁󱸀', 101: '󱸁󱸁', 102: '󱸁󱸂', 103: '󱸁󱸃', 104: '󱸁󱸄', 105: '󱸁󱸅', 110: '󱸁󱸆', 111: '󱸁󱸇', 112: '󱸁󱸈', 113: '󱸁󱸉', 114: '󱸁󱸊', 115: '󱸁󱸋', 120: '󱸁󱸌', 121: '󱸁󱸍', 122: '󱸁󱸎', 123: '󱸁󱸏', 124: '󱸁󱸐', 125: '󱸁󱸑', 1404: '󱸊󱸄', 1415: '󱸊󱸋'}) %}
        {% set UTAS = SezimalDictionary({0: '󱸀', 1: '󱸁', 2: '󱸂', 3: '󱸃', 4: '󱸄', 5: '󱸅', 10: '󱸆', 11: '󱸇', 12: '󱸈', 13: '󱸉', 14: '󱸊', 15: '󱸋', 20: '󱸌', 21: '󱸍', 22: '󱸎', 23: '󱸏', 24: '󱸐', 25: '󱸑', 30: '󱸒', 31: '󱸓', 32: '󱸔', 33: '󱸕', 34: '󱸖', 35: '󱸗', 40: '󱸘', 41: '󱸙', 42: '󱸚', 43: '󱸛', 44: '󱸜', 45: '󱸝', 50: '󱸞', 51: '󱸟', 52: '󱸠', 53: '󱸡', 54: '󱸢', 55: '󱸣'}) %}
        {% set HALF = '󱸒' %}
        {% set SEASON_MOON_TIME_FORMAT = '#@!u' + locale.TIME_SEPARATOR + '#@!p' %}
    {% elif format_token == 'Z' %}
        {% set NUMBERS = SezimalDictionary({0: '0', 1: '1', 2: '2', 3: '3', 4: '4', 5: '5', 10: '6', 11: '7', 12: '8', 13: '9', 14: 'A', 15: 'B', 20: 'C', 21: 'D', 22: 'E', 23: 'F', 24: 'G', 25: 'H', 30: 'I', 31: 'J', 32: 'K', 33: 'L', 34: 'M', 35: 'N', 40: 'O', 41: 'P', 42: 'Q', 43: 'R', 44: 'S', 45: 'T', 50: 'U', 51: 'V', 52: 'W', 53: 'X', 54: 'Y', 55: 'Z', 100: '10', 101: '11', 102: '12', 103: '13', 104: '14', 105: '15', 110: '16', 111: '17', 112: '18', 113: '19', 114: '1A', 115: '1B', 120: '1C', 121: '1D', 122: '1E', 123: '1F', 124: '1G', 125: '1H', 1404: 'A4', 1415: 'AB'}) %}
        {% set UTAS = SezimalDictionary({0: '0', 1: '1', 2: '2', 3: '3', 4: '4', 5: '5', 10: '6', 11: '7', 12: '8', 13: '9', 14: 'A', 15: 'B', 20: 'C', 21: 'D', 22: 'E', 23: 'F', 24: 'G', 25: 'H', 30: 'I', 31: 'J', 32: 'K', 33: 'L', 34: 'M', 35: 'N', 40: 'O', 41: 'P', 42: 'Q', 43: 'R', 44: 'S', 45: 'T', 50: 'U', 51: 'V', 52: 'W', 53: 'X', 54: 'Y', 55: 'Z'}) %}
        {% set HALF = 'I' %}
        {% set SEASON_MOON_TIME_FORMAT = '#Zu' + locale.TIME_SEPARATOR + '#Zp' %}
    {% endif %}
{% else %}
    {% set NUMBERS = SezimalDictionary({0: '0', 1: '1', 2: '2', 3: '3', 4: '4', 5: '5', 10: '10', 11: '11', 12: '12', 13: '13', 14: '14', 15: '15', 20: '20', 21: '21', 22: '22', 23: '23', 24: '24', 25: '25', 30: '30', 31: '31', 32: '32', 33: '33', 34: '34', 35: '35', 40: '40', 41: '41', 42: '42', 43: '43', 44: '44', 45: '45', 50: '50', 51: '51', 52: '52', 53: '53', 54: '54', 55: '55', 100: '100', 101: '101', 102: '102', 103: '103', 104: '104', 105: '105', 110: '110', 111: '111', 112: '112', 113: '113', 114: '114', 115: '115', 120: '120', 121: '121', 122: '122', 123: '123', 124: '124', 125: '125', 1404: '1404', 1415: '1415'}) %}

    {% set UTAS = SezimalDictionary({0: '00', 1: '01', 2: '02', 3: '03', 4: '04', 5: '05', 10: '10', 11: '11', 12: '12', 13: '13', 14: '14', 15: '15', 20: '20', 21: '21', 22: '22', 23: '23', 24: '24', 25: '25', 30: '30', 31: '31', 32: '32', 33: '33', 34: '34', 35: '35', 40: '40', 41: '41', 42: '42', 43: '43', 44: '44', 45: '45', 50: '50', 51: '51', 52: '52', 53: '53', 54: '54', 55: '55'}) %}
    {% set HOURS_24 = SezimalDictionary({0: '00', 1: '01', 2: '02', 3: '03', 4: '04', 5: '05', 10: '10', 11: '11', 12: '12', 13: '13', 14: '14', 15: '15', 20: '20', 21: '21', 22: '22', 23: '23', 24: '24', 25: '25', 30: '30', 31: '31', 32: '32', 33: '33', 34: '34', 35: '35', 40: '40', 41: '41', 42: '42', 43: '43', 44: '44', 45: '45', 50: '50', 51: '51', 52: '52', 53: '53', 54: '54', 55: '55'}) %}
    {% set HALF = '30' %}
    {% set SEPARATOR = locale.TIME_SEPARATOR %}
    {% set MIDDAY = 30 %}
    {% set SEASON_MOON_TIME_FORMAT = '#u' + locale.TIME_SEPARATOR + '#p' %}

    {% if sezimal_digits or format_token == '!' %}
        {% set NUMBERS = SezimalDictionary({0: '󱸀', 1: '󱸁', 2: '󱸂', 3: '󱸃', 4: '󱸄', 5: '󱸅', 10: '󱸁󱸀', 11: '󱸁󱸁', 12: '󱸁󱸂', 13: '󱸁󱸃', 14: '󱸁󱸄', 15: '󱸁󱸅', 20: '󱸂󱸀', 21: '󱸂󱸁', 22: '󱸂󱸂', 23: '󱸂󱸃', 24: '󱸂󱸄', 25: '󱸂󱸅', 30: '󱸃󱸀', 31: '󱸃󱸁', 32: '󱸃󱸂', 33: '󱸃󱸃', 34: '󱸃󱸄', 35: '󱸃󱸅', 40: '󱸄󱸀', 41: '󱸄󱸁', 42: '󱸄󱸂', 43: '󱸄󱸃', 44: '󱸄󱸄', 45: '󱸄󱸅', 50: '󱸅󱸀', 51: '󱸅󱸁', 52: '󱸅󱸂', 53: '󱸅󱸃', 54: '󱸅󱸄', 55: '󱸅󱸅', 100: '󱸁󱸀󱸀', 101: '󱸁󱸀󱸁', 102: '󱸁󱸀󱸂', 103: '󱸁󱸀󱸃', 104: '󱸁󱸀󱸄', 105: '󱸁󱸀󱸅', 110: '󱸁󱸁󱸀', 111: '󱸁󱸁󱸁', 112: '󱸁󱸁󱸂', 113: '󱸁󱸁󱸃', 114: '󱸁󱸁󱸄', 115: '󱸁󱸁󱸅', 120: '󱸁󱸂󱸀', 121: '󱸁󱸂󱸁', 122: '󱸁󱸂󱸂', 123: '󱸁󱸂󱸃', 124: '󱸁󱸂󱸄', 125: '󱸁󱸂󱸅', 1404: '󱸁󱸄󱸀󱸄', 1415: '󱸁󱸄󱸁󱸅'}) %}

        {% set UTAS = SezimalDictionary({0: '󱸀󱸀', 1: '󱸀󱸁', 2: '󱸀󱸂', 3: '󱸀󱸃', 4: '󱸀󱸄', 5: '󱸀󱸅', 10: '󱸁󱸀', 11: '󱸁󱸁', 12: '󱸁󱸂', 13: '󱸁󱸃', 14: '󱸁󱸄', 15: '󱸁󱸅', 20: '󱸂󱸀', 21: '󱸂󱸁', 22: '󱸂󱸂', 23: '󱸂󱸃', 24: '󱸂󱸄', 25: '󱸂󱸅', 30: '󱸃󱸀', 31: '󱸃󱸁', 32: '󱸃󱸂', 33: '󱸃󱸃', 34: '󱸃󱸄', 35: '󱸃󱸅', 40: '󱸄󱸀', 41: '󱸄󱸁', 42: '󱸄󱸂', 43: '󱸄󱸃', 44: '󱸄󱸄', 45: '󱸄󱸅', 50: '󱸅󱸀', 51: '󱸅󱸁', 52: '󱸅󱸂', 53: '󱸅󱸃', 54: '󱸅󱸄', 55: '󱸅󱸅'}) %}
        {% set HALF = '󱸃󱸀' %}
        {% set SEPARATOR = locale.TIME_SEPARATOR %}
        {% set SEASON_MOON_TIME_FORMAT = '#!u' + locale.TIME_SEPARATOR + '#!p' %}
    {% endif %}
{% endif %}

{% if locale.calendar_displayed == 'SYM' %}
    {% set date_format = locale.DATE_FORMAT %}
    {% set weekday_format = '#W' %}
    {% set event_month = date.month %}
    {% set event_day = date.day %}
{% elif locale.calendar_displayed == 'ISO' %}
    {% set date_format = locale.ISO_DATE_FORMAT %}
    {% set weekday_format = '#W' %}
    {% set event_month = date.gregorian_month %}
    {% set event_day = date.gregorian_day %}
{% elif locale.calendar_displayed == 'DCC' %}
    {% if 'c' in format_token %}
        {% set date_format = locale.ADC_DATE_FORMAT %}
    {% else %}
        {% set date_format = locale.DCC_DATE_FORMAT %}
    {% endif %}
    {% set weekday_format = '&' + format_token + 'W' %}
    {% set event_month = date.dcc_month %}
    {% set event_day = date.dcc_day %}
{% endif %}

<div class="center">
    <div class="now-content">
        <div id="calendar_header" class="calendar-header-now">
        <p class="now-weekday">
        {{ now.format(weekday_format, locale) }}
        {% if locale.calendar_displayed == 'DCC' and 'c' in format_token %}
            {% with dcc_weekday_number = date.dcc_weekday %}
                {% include 'calendar_span_adc_weekday_symbol.html' %}
            {% endwith %}
        {% endif %}
        </p>
        {% if base == 14 %}
            <p id="time_display" class="now-time-{{ hour_format }}">
        {% else %}
            <p id="time_display" class="now-time-24h">
        {% endif %}
        {% if ('/NT' in locale.DEFAULT_TIME_ZONE) or (locale.DEFAULT_TIME_ZONE in ('UTC', 'SPM')) %}
            <div id="natural_time_10" style="width: 50%; margin: auto; line-height: 0.8rem; font-size: 0.8rem; margin-top: -0.8rem;">
                <div id="natural_time" class="full-day-color">&nbsp;</div>
                <div id="natural_time_passed" class="day-time-passed">&nbsp;</div>
            </div>
        {% endif %}
        </p>

        <p class="now-date" style="clear: both;">
            {{ now.format(date_format, locale) }}
        </p>
        <div id="weather_view" style="display:none;"></div>
        <p clas="now-events">
            {% set ns = namespace(event_separator = '') %}
            {% if event_month in events %}
                {% if event_day in events[event_month] %}
                    {% for event in events[event_month][event_day] %}
                        {% if event.origin_calendar in locale.SHOW_HOLIDAYS %}
                            {% if ns.event_separator == '' %}&nbsp;{% endif %}<span class="emoji">{{ event.emoji }}</span> - {{ event.name }}{{ event_separator }}
                            {% if ns.event_separator == '' %}
                                {% set ns.event_separator = '; ' %}
                            {% endif %}
                        {% endif %}
                    {% endfor %}
                {% endif %}
            {% endif %}

            {% if event_month in events['moon'] %}
                {% if event_day in events['moon'][event_month] %}
                    {% for event in events['moon'][event_month][event_day] %}
                        {% if ns.event_separator == '' %}&nbsp;{% endif %}<span class="emoji">{{ event.emoji }}</span> - {{ event.name }}{{ event_separator }}
                        {% if ns.event_separator == '' %}
                            {% set ns.event_separator = '; ' %}
                        {% endif %}
                    {% endfor %}
                {% endif %}
            {% endif %}
        </p>
        <p class="now-iso-date">
            {% if locale.calendar_displayed != 'ISO' %}
                {% if locale.calendar_displayed == 'DCC' and locale.DATE_ENDIANNES != 'B' %}
                    {{ now.format('#@W, ', locale) }}
                {% endif %}
                {{ now.format(locale.ISO_DATE_FORMAT.replace('9', '').replace('5', '').replace('↋', ''), locale) }}
                {% if locale.calendar_displayed == 'DCC' and locale.DATE_ENDIANNES == 'B' %}
                    {{ now.format(', #@W', locale) }}
                {% endif %}
                {% if base != 14 %} — {% endif %}
            {% endif %}
            {% if base != 14 %}
                <span id="iso_time_display"></span>
                <span id="decimal_weather_display" style="display:none;"></span>
            {% endif %}
        </p>
        <p> </p>
        {% set year_view = True %}
        {% set now_view = True %}
        {% with weekday_name_size=3, sezimal_month_number=date.month, sezimal_year_number=date.year, dcc_month_number=date.dcc_month, dcc_year_number=date.dcc_year %}
            {% if locale.calendar_displayed == 'SYM' %}
                {% include 'calendar_base_month.html' %}
            {% elif locale.calendar_displayed == 'ISO' %}
                {% include 'calendar_base_iso_month.html' %}
            {% elif locale.calendar_displayed == 'DCC' %}
                {% include 'calendar_base_dcc_month.html' %}
            {% endif %}
        {% endwith %}
    </div>
</div>
