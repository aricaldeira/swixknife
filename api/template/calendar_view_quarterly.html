{% if not dark_mode %}
    {% include 'calendar_light_mode.html' %}
{% endif %}
<div id="calendar_header" class="calendar-header-fixed">
{% include 'calendar_view_change_view.html' %}
<table class="center" style="border-spacing: 0px;">
    <colgroup>
        <col span="1" width="5%">
        <col span="1" width="5%">
        <col span="1">
        <col span="1" width="5%">
        <col span="1" width="5%">
    </colgroup>
    <tr>
        <td colspan="5" style="font-size: 0.5rem; line-height: 0.5rem;"> </td>
    </tr>
    <tr style="vertical-align: middle;">
        <td style="font-size: 1.25rem; line-height: 2.25rem; font-weight: bold; background-color: white; color: black;" onclick="update_calendar('previous', 'quarter')">«</td>
        <td style="font-size: 1.25rem; line-height: 2.25rem; font-weight: bold; background-color: white; color: black;" onclick="update_calendar('previous', 'month')">‹</td>
        <td style="font-size: 1.25rem; line-height: 2.25rem; font-weight: bold; background-color: white; color: black;">
            {% if locale.calendar_displayed in ('SYM', 'ISO') %}
                {% if date_last_month.year == date_next_month.year and not locale.ISO_MODE %}
                    {{ date_last_month.format(locale.YEAR_FORMAT + locale.DATE_SEPARATOR, locale) if locale.DATE_ENDIANNESS == 'B' else ''}}{{ date_last_month.format('#M', locale) }} — {{ date_next_month.format('#M', locale) }}{{ date_next_month.format(locale.DATE_SEPARATOR + locale.YEAR_FORMAT, locale) if locale.DATE_ENDIANNESS != 'B' else ''}}
                {% else %}
                    {{ date_last_month.format(locale.YEAR_TEXT_MONTH_FORMAT, locale) }} — {{ date_next_month.format(locale.YEAR_TEXT_MONTH_FORMAT, locale) }}
                {% endif %}
            {% elif locale.calendar_displayed == 'DCC' %}
                <span class="hide-in-mobile">
                    {% if date_last_month.dcc_year == date_next_month.dcc_year %}
                        {{ date_last_month.format('&' + format_token + '>Y&DS&' + format_token + 'M', locale) }}
                        {% if 'c' in format_token %}
                            {% if date_last_month.dcc_month == 0 %}
                                <span class="constellation" title="PISCES">b</span>
                            {% elif date_last_month.dcc_month == 1 %}
                                <span class="constellation" title="CETUS">5</span>
                            {% elif date_last_month.dcc_month == 2 %}
                                <span class="constellation" title="ERIDANUS">D</span>
                            {% elif date_last_month.dcc_month == 3 %}
                                <span class="constellation" title="MONOCEROS">W</span>
                            {% elif date_last_month.dcc_month == 4 %}
                                <span class="constellation" title="HYDRA">J</span>
                            {% elif date_last_month.dcc_month == 5 %}
                                <span class="constellation" title="LEO">N</span>
                            {% elif date_last_month.dcc_month == 10 %}
                                <span class="constellation" title="VIRGO">v</span>
                            {% elif date_last_month.dcc_month == 11 %}
                                <span class="constellation" title="SERPENS">l</span>
                            {% elif date_last_month.dcc_month == 12 %}
                                <span class="constellation" title="AQUILA">%</span>
                            {% elif date_last_month.dcc_month == 13 %}
                                <span class="constellation" title="AQUARIUS">$</span>
                            {% elif date_last_month.dcc_month == 14 %}
                                <span class="constellation" title="LIBRA">Q</span>
                            {% endif %}
                        {% endif %}
                        —
                        {{ date_next_month.format('&' + format_token + 'M', locale) }}
                        {% if 'c' in format_token %}
                            {% if date_next_month.dcc_month == 0 %}
                                <span class="constellation" title="PISCES">b</span>
                            {% elif date_next_month.dcc_month == 1 %}
                                <span class="constellation" title="CETUS">5</span>
                            {% elif date_next_month.dcc_month == 2 %}
                                <span class="constellation" title="ERIDANUS">D</span>
                            {% elif date_next_month.dcc_month == 3 %}
                                <span class="constellation" title="MONOCEROS">W</span>
                            {% elif date_next_month.dcc_month == 4 %}
                                <span class="constellation" title="HYDRA">J</span>
                            {% elif date_next_month.dcc_month == 5 %}
                                <span class="constellation" title="LEO">N</span>
                            {% elif date_next_month.dcc_month == 10 %}
                                <span class="constellation" title="VIRGO">v</span>
                            {% elif date_next_month.dcc_month == 11 %}
                                <span class="constellation" title="SERPENS">l</span>
                            {% elif date_next_month.dcc_month == 12 %}
                                <span class="constellation" title="AQUILA">%</span>
                            {% elif date_next_month.dcc_month == 13 %}
                                <span class="constellation" title="AQUARIUS">$</span>
                            {% elif date_next_month.dcc_month == 14 %}
                                <span class="constellation" title="LIBRA">Q</span>
                            {% endif %}
                        {% endif %}
                    {% else %}
                        {{ date_last_month.format('&' + format_token + '>Y&DS&' + format_token + 'M', locale) }}
                        {% if 'c' in format_token %}
                            {% if date_last_month.dcc_month == 0 %}
                                <span class="constellation" title="PISCES">b</span>
                            {% elif date_last_month.dcc_month == 1 %}
                                <span class="constellation" title="CETUS">5</span>
                            {% elif date_last_month.dcc_month == 2 %}
                                <span class="constellation" title="ERIDANUS">D</span>
                            {% elif date_last_month.dcc_month == 3 %}
                                <span class="constellation" title="MONOCEROS">W</span>
                            {% elif date_last_month.dcc_month == 4 %}
                                <span class="constellation" title="HYDRA">J</span>
                            {% elif date_last_month.dcc_month == 5 %}
                                <span class="constellation" title="LEO">N</span>
                            {% elif date_last_month.dcc_month == 10 %}
                                <span class="constellation" title="VIRGO">v</span>
                            {% elif date_last_month.dcc_month == 11 %}
                                <span class="constellation" title="SERPENS">l</span>
                            {% elif date_last_month.dcc_month == 12 %}
                                <span class="constellation" title="AQUILA">%</span>
                            {% elif date_last_month.dcc_month == 13 %}
                                <span class="constellation" title="AQUARIUS">$</span>
                            {% elif date_last_month.dcc_month == 14 %}
                                <span class="constellation" title="LIBRA">Q</span>
                            {% endif %}
                        {% endif %}
                        —
                        {{ date_next_month.format('&' + format_token + '>Y&DS&' + format_token + 'M', locale) }}
                        {% if 'c' in format_token %}
                            {% if date_next_month.dcc_month == 0 %}
                                <span class="constellation" title="PISCES">b</span>
                            {% elif date_next_month.dcc_month == 1 %}
                                <span class="constellation" title="CETUS">5</span>
                            {% elif date_next_month.dcc_month == 2 %}
                                <span class="constellation" title="ERIDANUS">D</span>
                            {% elif date_next_month.dcc_month == 3 %}
                                <span class="constellation" title="MONOCEROS">W</span>
                            {% elif date_next_month.dcc_month == 4 %}
                                <span class="constellation" title="HYDRA">J</span>
                            {% elif date_next_month.dcc_month == 5 %}
                                <span class="constellation" title="LEO">N</span>
                            {% elif date_next_month.dcc_month == 10 %}
                                <span class="constellation" title="VIRGO">v</span>
                            {% elif date_next_month.dcc_month == 11 %}
                                <span class="constellation" title="SERPENS">l</span>
                            {% elif date_next_month.dcc_month == 12 %}
                                <span class="constellation" title="AQUILA">%</span>
                            {% elif date_next_month.dcc_month == 13 %}
                                <span class="constellation" title="AQUARIUS">$</span>
                            {% elif date_next_month.dcc_month == 14 %}
                                <span class="constellation" title="LIBRA">Q</span>
                            {% endif %}
                        {% endif %}
                    {% endif %}
                </span>
                <span class="show-in-mobile">
                    {% if date_last_month.dcc_year == date_next_month.dcc_year %}
                        {{ date_last_month.format('&' + format_token + '>Y&DS&' + format_token + '@M', locale) }}
                        {% if 'c' in format_token %}
                            {% if date_last_month.dcc_month == 0 %}
                                <span class="constellation" title="PISCES">b</span>
                            {% elif date_last_month.dcc_month == 1 %}
                                <span class="constellation" title="CETUS">5</span>
                            {% elif date_last_month.dcc_month == 2 %}
                                <span class="constellation" title="ERIDANUS">D</span>
                            {% elif date_last_month.dcc_month == 3 %}
                                <span class="constellation" title="MONOCEROS">W</span>
                            {% elif date_last_month.dcc_month == 4 %}
                                <span class="constellation" title="HYDRA">J</span>
                            {% elif date_last_month.dcc_month == 5 %}
                                <span class="constellation" title="LEO">N</span>
                            {% elif date_last_month.dcc_month == 10 %}
                                <span class="constellation" title="VIRGO">v</span>
                            {% elif date_last_month.dcc_month == 11 %}
                                <span class="constellation" title="SERPENS">l</span>
                            {% elif date_last_month.dcc_month == 12 %}
                                <span class="constellation" title="AQUILA">%</span>
                            {% elif date_last_month.dcc_month == 13 %}
                                <span class="constellation" title="AQUARIUS">$</span>
                            {% elif date_last_month.dcc_month == 14 %}
                                <span class="constellation" title="LIBRA">Q</span>
                            {% endif %}
                        {% endif %}
                        —
                        {{ date_next_month.format('&' + format_token + '@M', locale) }}
                        {% if 'c' in format_token %}
                            {% if date_next_month.dcc_month == 0 %}
                                <span class="constellation" title="PISCES">b</span>
                            {% elif date_next_month.dcc_month == 1 %}
                                <span class="constellation" title="CETUS">5</span>
                            {% elif date_next_month.dcc_month == 2 %}
                                <span class="constellation" title="ERIDANUS">D</span>
                            {% elif date_next_month.dcc_month == 3 %}
                                <span class="constellation" title="MONOCEROS">W</span>
                            {% elif date_next_month.dcc_month == 4 %}
                                <span class="constellation" title="HYDRA">J</span>
                            {% elif date_next_month.dcc_month == 5 %}
                                <span class="constellation" title="LEO">N</span>
                            {% elif date_next_month.dcc_month == 10 %}
                                <span class="constellation" title="VIRGO">v</span>
                            {% elif date_next_month.dcc_month == 11 %}
                                <span class="constellation" title="SERPENS">l</span>
                            {% elif date_next_month.dcc_month == 12 %}
                                <span class="constellation" title="AQUILA">%</span>
                            {% elif date_next_month.dcc_month == 13 %}
                                <span class="constellation" title="AQUARIUS">$</span>
                            {% elif date_next_month.dcc_month == 14 %}
                                <span class="constellation" title="LIBRA">Q</span>
                            {% endif %}
                        {% endif %}
                    {% else %}
                        {{ date_last_month.format('&' + format_token + '>Y&DS&' + format_token + '@M', locale) }}
                        {% if 'c' in format_token %}
                            {% if date_last_month.dcc_month == 0 %}
                                <span class="constellation" title="PISCES">b</span>
                            {% elif date_last_month.dcc_month == 1 %}
                                <span class="constellation" title="CETUS">5</span>
                            {% elif date_last_month.dcc_month == 2 %}
                                <span class="constellation" title="ERIDANUS">D</span>
                            {% elif date_last_month.dcc_month == 3 %}
                                <span class="constellation" title="MONOCEROS">W</span>
                            {% elif date_last_month.dcc_month == 4 %}
                                <span class="constellation" title="HYDRA">J</span>
                            {% elif date_last_month.dcc_month == 5 %}
                                <span class="constellation" title="LEO">N</span>
                            {% elif date_last_month.dcc_month == 10 %}
                                <span class="constellation" title="VIRGO">v</span>
                            {% elif date_last_month.dcc_month == 11 %}
                                <span class="constellation" title="SERPENS">l</span>
                            {% elif date_last_month.dcc_month == 12 %}
                                <span class="constellation" title="AQUILA">%</span>
                            {% elif date_last_month.dcc_month == 13 %}
                                <span class="constellation" title="AQUARIUS">$</span>
                            {% elif date_last_month.dcc_month == 14 %}
                                <span class="constellation" title="LIBRA">Q</span>
                            {% endif %}
                        {% endif %}
                        —
                        {{ date_next_month.format('&' + format_token + '>Y&DS&' + format_token + '@M', locale) }}
                        {% if 'c' in format_token %}
                            {% if date_next_month.dcc_month == 0 %}
                                <span class="constellation" title="PISCES">b</span>
                            {% elif date_next_month.dcc_month == 1 %}
                                <span class="constellation" title="CETUS">5</span>
                            {% elif date_next_month.dcc_month == 2 %}
                                <span class="constellation" title="ERIDANUS">D</span>
                            {% elif date_next_month.dcc_month == 3 %}
                                <span class="constellation" title="MONOCEROS">W</span>
                            {% elif date_next_month.dcc_month == 4 %}
                                <span class="constellation" title="HYDRA">J</span>
                            {% elif date_next_month.dcc_month == 5 %}
                                <span class="constellation" title="LEO">N</span>
                            {% elif date_next_month.dcc_month == 10 %}
                                <span class="constellation" title="VIRGO">v</span>
                            {% elif date_next_month.dcc_month == 11 %}
                                <span class="constellation" title="SERPENS">l</span>
                            {% elif date_next_month.dcc_month == 12 %}
                                <span class="constellation" title="AQUILA">%</span>
                            {% elif date_next_month.dcc_month == 13 %}
                                <span class="constellation" title="AQUARIUS">$</span>
                            {% elif date_next_month.dcc_month == 14 %}
                                <span class="constellation" title="LIBRA">Q</span>
                            {% endif %}
                        {% endif %}
                    {% endif %}
                </span>
            {% endif %}
        </td>
        <td style="font-size: 1.25rem; line-height: 2.25rem; font-weight: bold; background-color: white; color: black;" onclick="update_calendar('next', 'month')">›</td>
        <td style="font-size: 1.25rem; line-height: 2.25rem; font-weight: bold; background-color: white; color: black;" onclick="update_calendar('next', 'quarter')">»</td>
    </tr>
    <tr>
        <td colspan="5" style="font-size: 0.5rem; line-height: 0.5rem;"> </td>
    </tr>
</table>
</div>
<div id="trimester_table">
    <div style="clear: both;">
        <div{% if not mobile %} style="float: {{ 'right' if locale.RTL else 'left' }}; width: 32.66%;"{% endif %}>
            {% with year_view=True, reference_date=date_last_month, sezimal_month_number=date_last_month.month, sezimal_year_number=date_last_month.year, weekday_name_size=1, dcc_month_number=date_last_month.dcc_month, dcc_year_number=date_last_month.dcc_year %}
                {% if locale.calendar_displayed == 'SYM' %}
                    {% include 'calendar_base_month.html' %}
                {% elif locale.calendar_displayed == 'ISO' %}
                    {% include 'calendar_base_iso_month.html' %}
                {% elif locale.calendar_displayed == 'DCC' %}
                    {% include 'calendar_base_dcc_month.html' %}
                {% endif %}
            {% endwith %}
        </div>
        {% if not mobile %}
            <div style="float: {{ 'right' if locale.RTL else 'left' }}; width: 1%;"> </div>
        {% endif %}
        <div{% if not mobile %} style="float: {{ 'right' if locale.RTL else 'left' }}; width: 32.66%;"{% endif %}>
            {% with year_view=True, sezimal_month_number=date.month, sezimal_year_number=date.year, weekday_name_size=1, dcc_month_number=date.dcc_month, dcc_year_number=date.dcc_year %}
                {% if locale.calendar_displayed == 'SYM' %}
                    {% include 'calendar_base_month.html' %}
                {% elif locale.calendar_displayed == 'ISO' %}
                    {% include 'calendar_base_iso_month.html' %}
                {% elif locale.calendar_displayed == 'DCC' %}
                    {% include 'calendar_base_dcc_month.html' %}
                {% endif %}
            {% endwith %}
        </div>
        {% if not mobile %}
            <div style="float: {{ 'right' if locale.RTL else 'left' }}; width: 1%;"> </div>
        {% endif %}
        <div{% if not mobile %} style="float: {{ 'right' if locale.RTL else 'left' }}; width: 32.66%;"{% endif %}>
            {% with year_view=True, reference_date=date_next_month, sezimal_month_number=date_next_month.month, sezimal_year_number=date_next_month.year, weekday_name_size=1, dcc_month_number=date_next_month.dcc_month, dcc_year_number=date_next_month.dcc_year %}
                {% if locale.calendar_displayed == 'SYM' %}
                    {% include 'calendar_base_month.html' %}
                {% elif locale.calendar_displayed == 'ISO' %}
                    {% include 'calendar_base_iso_month.html' %}
                {% elif locale.calendar_displayed == 'DCC' %}
                    {% include 'calendar_base_dcc_month.html' %}
                {% endif %}
            {% endwith %}
        </div>
    </div>
</div>

<script type="text/javascript" id="view_script">
function auto_refresh(){
    const header_height = document.getElementById('calendar_header').getBoundingClientRect().height;

    document.getElementById('trimester_table').setAttribute(
        'style',
        'border-spacing: 0px; padding-top: ' + header_height + 'px;'
    );
};
auto_refresh();

//
// When first loading the page, makes
// shure today’s date is visible
//
function center_today() {
    const today_rect = document.getElementById('today').getBoundingClientRect();
    window.scrollTo(
        0,
        //
        // Page middle
        //
        (today_rect.top + window.pageYOffset) - (window.innerHeight / 2)
    );
};
center_today();
</script>
