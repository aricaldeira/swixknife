

from decimal import Decimal

from .sezimal import Sezimal, SezimalInteger
from .base import sezimal_context


PI = Sezimal('3.050_330_051_415_124_105_234_414_053_125_321_102_301_214_442_004_115_252_553_314_203_331_311_355_351_312_334_553_341_001_515_434_440_123_435_445_203_004_500_242_234_314_025_131_145_211_002_025_103_101_050_341_035_513_553_305_055_032_553_300_321_441_523_154_243_140_500_010_113_054_135_235_552_155_133_504_313_345_222_145_305_202_151_005_141_542_212_553_225_024_214_010_503_555_555_042')

PI_RECIPROCAL = Sezimal('0.152_431_022_133_341_414_113_121_401_254_553_421_135_244_440_151_140_333_542_253_244_413_350_145_552_520_305_312_443_045_031_214_434_340_310_312_242_532_204_410_535_130_230_213_521_013_220_511_243_242_411_115_413_200_113_004_122_555_035_353_001_003_332_440_120_313_020_043_031_522_140_001_044_314_122_322_112_503_343_545_103_242_454_552_051_021_245_234_043_121_132_504_553_533_430_212')

PI.reciprocal = PI_RECIPROCAL
PI_RECIPROCAL.reciprocal = PI

TAU = Sezimal('10.141_100_143_234_252_214_513_232_150_255_042_205_002_433_324_012_234_545_551_032_411_103_023_155_143_025_113_551_122_003_435_313_320_251_315_334_410_013_400_524_513_032_054_302_334_422_004_054_210_202_141_122_115_431_551_014_154_105_551_001_043_323_450_352_530_321_400_020_230_152_314_515_544_354_311_413_031_134_444_335_014_404_342_014_323_524_425_550_454_052_432_021_411_555_554_124')

TAU_RECIPROCAL = Sezimal('0.054_213_311_044_450_505_034_340_500_425_254_510_345_422_220_053_350_144_551_124_422_204_453_052_554_240_132_434_221_322_313_405_215_150_133_134_121_244_102_203_245_343_113_104_540_304_410_233_421_421_203_335_504_400_034_302_041_255_315_454_300_301_444_220_040_134_310_021_313_541_050_000_322_135_041_141_034_231_451_552_331_421_225_254_023_310_422_415_021_340_344_232_254_544_513_104')

TAU.reciprocal = TAU_RECIPROCAL
TAU_RECIPROCAL.reciprocal = TAU

E = Sezimal('2.415_052_053_524_243_123_125_404_352_354_404_354_235_032_444_010_214_412_000_353_012_152_354_401_351_421_544_003_502_514_325_453_330_435_415_042_012_241_053_505_121_505_002_543_115_435_140_342_250_351_044_132_504_002_231_153_215_124_443_103_545_353_232_131_354_445_224_542_442_101_220_301_332_000_405_033_505_314_201_023_144_034_255_530_300_353_342_032_122_311_052_225_024_544_154_045')

E_RECIPROCAL = Sezimal('0.211_243_441_101_153_004_435_235_055_143_300_214_114_152_225_300_310_115_102_054_500_341_533_233_444_323_214_003_104_140_322_424_552_441_523_141_555_515_244_552_035_344_551_552_521_510_211_123_310_301_540_230_312_223_133_111_503_314_422_344_201_004_055_103_104_535_014_241_234_210_442_520_244_001_512_212_011_541_021_024_014_312_353_154_244_142_242_214_143_341_425_423_143_214_541_451')

E.reciprocal = E_RECIPROCAL
E_RECIPROCAL.reciprocal = E

LN_2 = Sezimal('0.405_415_250_322_520_250_433_345_043_122_455_323_313_011_331_331_121_101_025_243_411_040_212_401_211_221_321_300_004_323_441_110_043_444_121_313_234_230_531_412_353_422_313_224_522_003_151_341_000_504_220_103_423_533_325_430_302_334_044_555_152_052_402_205_220_253_353_100_312_223_241_220_034_503_122_352_441_221_504_343_135_330_250_114_452_424_420_225_503_443_104_504_511_353_055_202')

LN_3 = Sezimal('1.033_144_504_400_030_230_314_515_344_424_100_405_112_533_312_424_352_553_112_403_550_050_324_330_103_025_524_334_134_422_144_523_321_511_353_555_415_151_434_053_030_351_344_410_241_242_222_232_443_012_054_044_230_154_045_041_230_200_531_011_522_421_004_333_445_144_215_332_001_350_102_505_433_015_520_345_114_231_524_242_511_132_322_214_333_011_145_012_434_251_013_431_314_240_502_302')

LN_4 = Sezimal('1.215_234_541_045_440_541_311_134_130_245_355_051_030_023_103_102_242_202_054_531_222_120_425_202_422_443_043_000_013_051_322_220_131_332_243_030_512_501_503_225_151_245_030_453_444_010_343_122_001_412_440_211_251_511_055_301_005_112_133_554_344_145_204_414_440_551_150_201_024_450_522_440_113_410_245_145_322_443_413_130_315_100_540_233_345_253_240_455_411_330_213_413_423_150_154_403')

LN_5 = Sezimal('1.335_345_534_002_401_505_045_535_310_120_423_150_133_153_240_225_043_040_021_245_452_032_055_532_520_454_241_030_431_012_254_314_111_433_112_352_511_535_150_513_243_550_114_302_115_352_254_250_150_110_313_425_530_200_442_535_143_355_225_024_232_345_453_544_423_453_443_205_311_031_054_211_143_332_400_043_402_050_233_255_322_452_430_032_425_013_043_244_012_145_251_254_222_314_443_320')

LN_10 = Sezimal('1.443_004_155_122_550_521_152_304_431_551_000_132_425_545_044_155_514_054_142_051_401_130_541_131_314_251_250_034_143_150_030_033_405_355_515_313_053_422_405_505_424_214_102_035_203_245_414_013_443_520_314_152_054_131_414_511_532_535_020_011_114_513_410_543_105_442_012_432_314_013_344_125_511_523_043_141_555_453_433_030_050_503_012_333_225_440_005_242_342_134_122_340_230_034_001_504')

SQRT_2 = Sezimal('1.225_245_314_205_523_321_432_232_430_442_403_335_434_412_002_245_345_012_543_502_523_355_352_352_014_242_432_155_314_241_020_123_015_343_122_054_523_455_402_132_024_312_224_050_203_011_553_034_442_444_442_551_321_244_053_115_455_255_003_405_503_054_323_342_523_521_124_330_423_143_353_320_443_244_211_133_002_340_423_114_532_522_035_433_442_121_411_414_143_042_020_323_435_442_015_023')

SQRT_2_RECIPROCAL = Sezimal('0.412_422_435_102_541_440_514_114_213_221_201_445_515_204_001_122_452_304_251_531_241_455_454_154_005_121_214_055_435_120_310_041_305_451_341_025_241_525_501_044_012_134_112_023_101_303_554_315_221_222_221_253_440_422_024_335_525_425_301_502_531_325_141_451_241_540_342_143_211_351_454_440_221_422_103_344_301_150_211_335_244_241_015_514_521_040_503_505_051_321_010_141_515_521_005_311')

SQRT_2.reciprocal = SQRT_2_RECIPROCAL
SQRT_2_RECIPROCAL.reciprocal = SQRT_2

SQRT_3 = Sezimal('1.422_042_321_254_545_342_041_213_412_413_330_143_311_402_110_015_204_041_100_111_514_121_105_431_331_042_410_101_122_420_113_424_340_520_500_505_252_033_154_235_505_230_302_242_320_331_042_304_232_553_420_502_425_404_343_403_145_112_544_100_540_041_044_403_504_114_112_045_434_505_330_110_100_155_314_451_110_001_320_521_552_423_211_110_541_243_135_222_545_115_112_353_224_433_500_353')
SQRT_3_RECIPROCAL = Sezimal('0.324_412_504_255_353_512_412_243_122_523_110_033_102_320_422_003_441_212_220_022_343_224_221_530_310_212_522_020_224_524_023_125_312_144_140_141_454_411_035_251_541_450_100_452_504_110_212_501_250_555_124_140_525_521_313_121_033_422_553_220_152_012_213_321_141_223_222_413_531_341_510_022_020_035_503_334_222_000_304_144_354_525_042_222_152_253_031_444_553_423_422_515_130_015_105_115')

SQRT_3.reciprocal = SQRT_3_RECIPROCAL
SQRT_3_RECIPROCAL.reciprocal = SQRT_3

SQRT_5 = Sezimal('2.122_553_553_151_303_343_124_514_320_340_240_134_540_252_132_232_033_250_215_441_101_321_550_100_045_314_112_514_250_000_113_451_353_425_153_113_500_153_022_112_254_334_142_424_110_105_531_034_505_111_133_523_432_542_224_022_212_442_452_021_331_232_541_142_115_331_543_011_034_221_022_352_153_212_002_225_543_532_230_151_445_000_205_431_303_433_304_320_301_012_302_030_422_114_313_033')
SQRT_5_RECIPROCAL = Sezimal('0.240_333_110_355_034_154_125_435_413_420_031_130_553_410_241_404_004_143_402_205_011_302_443_344_454_413_124_102_032_222_235_321_310_425_510_350_433_355_225_124_033_153_131_425_350_012_215_004_323_235_015_325_315_220_252_002_512_542_544_002_415_030_331_242_502_152_443_001_230_513_451_421_355_250_222_514_443_104_030_021_321_000_023_315_034_204_145_413_411_224_034_003_331_445_320_524')

SQRT_5.reciprocal = SQRT_5_RECIPROCAL
SQRT_5_RECIPROCAL.reciprocal = SQRT_5

SQRT_10 = Sezimal('2.241_031_220_552_145_325_004_320_404_110_552_053_210_432_015_503_111_534_133_122_315_240_154_303_044_040_253_252_543_511_045_535_535_134_550_125_104_342_311_040_204_453_302_102_322_545_031_434_042_001_104_302_415_045_025_345_413_142_435_313_142_423_352_151_530_151_040_230_003_421_043_332_404_020_355_254_150_134_353_344_153_335_352_005_110_012_401_154_153_345_221_252_115_442_004_313')
SQRT_10_RECIPROCAL = Sezimal('0.224_103_122_055_214_532_500_432_040_411_055_205_321_043_201_550_311_153_413_312_231_524_015_430_304_404_025_325_254_351_104_553_553_513_455_012_510_434_231_104_020_445_330_210_232_254_503_143_404_200_110_430_241_504_502_534_541_314_243_531_314_242_335_215_153_015_104_023_000_342_104_333_240_402_035_525_415_013_435_334_415_333_535_200_511_001_240_115_415_334_522_125_115_540_125_422')

SQRT_10.reciprocal = SQRT_10_RECIPROCAL
SQRT_10_RECIPROCAL.reciprocal = SQRT_10

GOLDEN_RATIO = Sezimal('1.341_254_554_353_431_451_342_235_140_150_120_045_250_124_044_114_014_423_105_520_330_440_553_030_022_435_034_235_123_000_034_523_454_512_354_334_530_054_311_034_125_145_051_212_033_032_543_315_232_333_344_541_514_251_112_011_104_221_224_010_443_414_250_351_035_443_551_303_315_110_311_154_054_404_001_112_551_544_113_053_522_300_102_513_431_514_432_140_130_304_131_013_101_150_330_224')

GOLDEN_RATIO_RECIPROCAL = Sezimal('0.341_254_554_353_431_451_342_235_140_150_120_045_250_124_044_114_014_423_105_520_330_440_553_030_022_435_034_235_123_000_034_523_454_512_354_334_530_054_311_034_125_145_051_212_033_032_543_315_232_333_344_541_514_251_112_011_104_221_224_010_443_414_250_351_035_443_551_303_315_110_311_154_054_404_001_112_551_544_113_053_522_300_102_513_431_514_432_140_130_304_131_013_101_150_330_224')

GOLDEN_RATIO.reciprocal = GOLDEN_RATIO_RECIPROCAL
GOLDEN_RATIO_RECIPROCAL.reciprocal = GOLDEN_RATIO


#
# Speed of light in vacuum
#
# C = Sezimal('134_535_421_043')
# C_AGRIMA = C
# C_ANUGA = C_AGRIMA * 100
# C_POSHA = C_ANUGA * 100
# C_UTA = C_POSHA * 100
# C_DAY = C_UTA * C_UTA
# C_YEAR = C_DAY * SezimalFraction('10_433 / 4')
#
# AU = SezimalFraction('44_554_300_353_113_321_300 / 2_211')


def cos_par(x):
    while x > 1:
        x -= 1

    if x == Sezimal('0') or x == Sezimal('1'):
        return SezimalInteger(1)
    elif x == Sezimal('0.013'):  # 1⁄40
        return (SQRT_10 + SQRT_2) / 4
    elif x == Sezimal('0.01..4'):  # 1⁄32
        return (10 + (2 * SQRT_5)).sqrt() / 4
    elif x == Sezimal('0.021_3'):  # 1⁄24
        return (2 + SQRT_2).sqrt() / 2
    elif x == Sezimal('0.03'):  # 1⁄20
        return SQRT_3 / 2
    elif x == Sezimal('0.0..3'):  # 1⁄14
        return (SQRT_5 + 1) / 4
    elif x == Sezimal('0.043'):  # 1⁄12
        return SQRT_2 / 2
    elif x == Sezimal('0.05..2'):  # 3⁄32
        return (14 - (2 * SQRT_5)).sqrt() / 4
    elif x == Sezimal('0.1'):  # 1⁄10
        return Sezimal('0.3')
    elif x == Sezimal('0.104_3'):  # 3⁄24
        return (2 - SQRT_2).sqrt() / 2
    elif x == Sezimal('0..11'):  # 1⁄5
        return (SQRT_5 - 1) / 4
    elif x == Sezimal('0.113'):  # 5⁄40
        return (SQRT_10 - SQRT_2) / 4
    elif x == Sezimal('0.13'):  # 1⁄4
        return Sezimal(0)

    return cos_rad(x * TAU)

def cos_rad(x):
    while x >= TAU:
        x -= TAU

    sezimal_context.sezimal_precision_decimal += 4

    i, last_result, s, den, num, sign = \
        Sezimal(0), Sezimal(0), Sezimal(1), Sezimal(1), Sezimal(1), Sezimal(1)

    while s != last_result:
        last_result = s
        i += 2
        num *= x * x
        den = i.factorial()
        sign *= -1
        s += sign * (num / den)
        print(i, last_result, s, den, num, sign)

    sezimal_context.sezimal_precision_decimal -= 4

    return round(s, sezimal_context.sezimal_precision)
